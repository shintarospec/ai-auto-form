<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form Automation Test - AI AutoForm</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-slate-900 text-slate-200 min-h-screen p-8">
    <div class="max-w-6xl mx-auto">
        <!-- Header -->
        <div class="mb-8">
            <h1 class="text-3xl font-bold text-white mb-2">
                <i class="fa-solid fa-robot text-green-500 mr-3"></i>
                Playwright ãƒ•ã‚©ãƒ¼ãƒ è‡ªå‹•å…¥åŠ›ãƒ†ã‚¹ãƒˆ
            </h1>
            <p class="text-slate-400">ãƒ–ãƒ©ã‚¦ã‚¶è‡ªå‹•åŒ–ã®ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Left: Control Panel -->
            <div class="space-y-6">
                <!-- Test Form URL -->
                <div class="bg-slate-800 rounded-xl p-6 border border-slate-700">
                    <h2 class="text-lg font-bold text-white mb-4">
                        <i class="fa-solid fa-link mr-2"></i>
                        ãƒ†ã‚¹ãƒˆå¯¾è±¡ãƒ•ã‚©ãƒ¼ãƒ 
                    </h2>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-xs font-bold text-slate-400 uppercase mb-2">ãƒ•ã‚©ãƒ¼ãƒ URL</label>
                            <input type="url" id="form-url" 
                                   value="http://localhost:8000/test-form.html"
                                   class="w-full bg-slate-700 border border-slate-600 rounded-lg p-3 text-white focus:ring-2 focus:ring-green-500 outline-none">
                        </div>
                        
                        <div class="grid grid-cols-2 gap-3">
                            <button onclick="useTestForm()" class="bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg font-bold transition">
                                <i class="fa-solid fa-flask mr-1"></i>
                                ãƒ†ã‚¹ãƒˆãƒ•ã‚©ãƒ¼ãƒ 
                            </button>
                            <button onclick="useCustomURL()" class="bg-purple-600 hover:bg-purple-500 text-white px-4 py-2 rounded-lg font-bold transition">
                                <i class="fa-solid fa-globe mr-1"></i>
                                ã‚«ã‚¹ã‚¿ãƒ URL
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Form Data -->
                <div class="bg-slate-800 rounded-xl p-6 border border-slate-700">
                    <h2 class="text-lg font-bold text-white mb-4">
                        <i class="fa-solid fa-database mr-2"></i>
                        å…¥åŠ›ãƒ‡ãƒ¼ã‚¿
                    </h2>
                    
                    <div class="space-y-3">
                        <div>
                            <label class="block text-xs text-slate-400 mb-1">åå‰</label>
                            <input type="text" id="data-name" value="å±±ç”°å¤ªéƒ" 
                                   class="w-full bg-slate-700 border border-slate-600 rounded p-2 text-sm text-white">
                        </div>
                        <div>
                            <label class="block text-xs text-slate-400 mb-1">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</label>
                            <input type="email" id="data-email" value="test@example.com" 
                                   class="w-full bg-slate-700 border border-slate-600 rounded p-2 text-sm text-white">
                        </div>
                        <div>
                            <label class="block text-xs text-slate-400 mb-1">ä¼šç¤¾å</label>
                            <input type="text" id="data-company" value="ãƒ†ã‚¹ãƒˆæ ªå¼ä¼šç¤¾" 
                                   class="w-full bg-slate-700 border border-slate-600 rounded p-2 text-sm text-white">
                        </div>
                        <div>
                            <label class="block text-xs text-slate-400 mb-1">é›»è©±ç•ªå·</label>
                            <input type="tel" id="data-phone" value="03-1234-5678" 
                                   class="w-full bg-slate-700 border border-slate-600 rounded p-2 text-sm text-white">
                        </div>
                        <div>
                            <label class="block text-xs text-slate-400 mb-1">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</label>
                            <textarea id="data-message" rows="4" 
                                      class="w-full bg-slate-700 border border-slate-600 rounded p-2 text-sm text-white">çªç„¶ã®ã”é€£çµ¡å¤±ç¤¼ã„ãŸã—ã¾ã™ã€‚
ãƒ†ã‚¹ãƒˆæ ªå¼ä¼šç¤¾ã®å±±ç”°ã¨ç”³ã—ã¾ã™ã€‚

è²´ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ã«å¤§å¤‰èˆˆå‘³ã‚’æŒã¡ã¾ã—ãŸã€‚
è©³ç´°ã«ã¤ã„ã¦ãŠè©±ã—ã•ã›ã¦ã„ãŸã ã‘ã‚Œã°ã¨æ€ã„ã¾ã™ã€‚</textarea>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="bg-gradient-to-r from-green-900/30 to-blue-900/30 rounded-xl p-6 border border-green-700/50">
                    <button onclick="startAutomation()" 
                            class="w-full bg-green-600 hover:bg-green-500 text-white px-6 py-4 rounded-lg font-bold text-lg shadow-lg transition">
                        <i class="fa-solid fa-play mr-2"></i>
                        è‡ªå‹•å…¥åŠ›ã‚’é–‹å§‹
                    </button>
                    <p class="text-xs text-slate-400 mt-3 text-center">
                        âš ï¸ ã“ã®ãƒœã‚¿ãƒ³ã¯ç¾åœ¨APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆçµŒç”±ã§å‹•ä½œã—ã¾ã™ï¼ˆå®Ÿè£…äºˆå®šï¼‰
                    </p>
                </div>
            </div>

            <!-- Right: Status & Logs -->
            <div class="space-y-6">
                <!-- Status -->
                <div class="bg-slate-800 rounded-xl p-6 border border-slate-700">
                    <h2 class="text-lg font-bold text-white mb-4">
                        <i class="fa-solid fa-chart-line mr-2"></i>
                        å®Ÿè¡Œã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
                    </h2>
                    
                    <div id="status-display" class="space-y-3">
                        <div class="flex items-center gap-3 p-3 bg-slate-900 rounded-lg">
                            <div class="w-3 h-3 rounded-full bg-slate-500"></div>
                            <span class="text-slate-400">å¾…æ©Ÿä¸­...</span>
                        </div>
                    </div>
                </div>

                <!-- Logs -->
                <div class="bg-slate-800 rounded-xl p-6 border border-slate-700">
                    <h2 class="text-lg font-bold text-white mb-4">
                        <i class="fa-solid fa-terminal mr-2"></i>
                        å®Ÿè¡Œãƒ­ã‚°
                    </h2>
                    
                    <div id="log-display" class="bg-slate-950 rounded-lg p-4 max-h-96 overflow-auto font-mono text-sm">
                        <div class="text-slate-500">ãƒ­ã‚°ã¯ã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...</div>
                    </div>
                </div>

                <!-- Expected Behavior -->
                <div class="bg-blue-900/20 rounded-xl p-6 border border-blue-700/50">
                    <h3 class="text-sm font-bold text-blue-300 mb-3">
                        <i class="fa-solid fa-info-circle mr-2"></i>
                        æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ
                    </h3>
                    <ul class="text-xs text-slate-300 space-y-2">
                        <li>âœ… ãƒ–ãƒ©ã‚¦ã‚¶ãŒè‡ªå‹•ã§èµ·å‹•</li>
                        <li>âœ… æŒ‡å®šURLã®ãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‹ã</li>
                        <li>âœ… å„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«è‡ªå‹•å…¥åŠ›</li>
                        <li>âœ… reCAPTCHAæ¤œå‡ºæ™‚ã¯ä¸€æ™‚åœæ­¢</li>
                        <li>âœ… ä½œæ¥­è€…ãŒæ‰‹å‹•ã§é€ä¿¡å®Œäº†</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Quick Links -->
        <div class="mt-8 flex gap-4">
            <a href="/admin-console.html" class="text-indigo-400 hover:text-indigo-300 transition">
                <i class="fa-solid fa-arrow-left mr-2"></i>
                ç®¡ç†è€…ç”»é¢ã«æˆ»ã‚‹
            </a>
            <a href="/test-form.html" target="_blank" class="text-green-400 hover:text-green-300 transition">
                <i class="fa-solid fa-external-link mr-2"></i>
                ãƒ†ã‚¹ãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‹ã
            </a>
        </div>
    </div>

    <script>
        const statusDisplay = document.getElementById('status-display');
        const logDisplay = document.getElementById('log-display');

        function addLog(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const colors = {
                info: 'text-blue-400',
                success: 'text-green-400',
                warning: 'text-yellow-400',
                error: 'text-red-400'
            };
            
            const logEntry = document.createElement('div');
            logEntry.className = colors[type];
            logEntry.textContent = `[${timestamp}] ${message}`;
            
            if (logDisplay.querySelector('.text-slate-500')) {
                logDisplay.innerHTML = '';
            }
            
            logDisplay.appendChild(logEntry);
            logDisplay.scrollTop = logDisplay.scrollHeight;
        }

        function updateStatus(message, status = 'running') {
            const colors = {
                idle: 'bg-slate-500',
                running: 'bg-yellow-500 animate-pulse',
                success: 'bg-green-500',
                error: 'bg-red-500'
            };
            
            statusDisplay.innerHTML = `
                <div class="flex items-center gap-3 p-3 bg-slate-900 rounded-lg">
                    <div class="w-3 h-3 rounded-full ${colors[status]}"></div>
                    <span class="text-white">${message}</span>
                </div>
            `;
        }

        function useTestForm() {
            document.getElementById('form-url').value = 'http://localhost:8000/test-form.html';
            addLog('ãƒ†ã‚¹ãƒˆãƒ•ã‚©ãƒ¼ãƒ URLã‚’è¨­å®šã—ã¾ã—ãŸ', 'success');
        }

        function useCustomURL() {
            const url = prompt('ã‚«ã‚¹ã‚¿ãƒ URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:');
            if (url) {
                document.getElementById('form-url').value = url;
                addLog(`ã‚«ã‚¹ã‚¿ãƒ URLè¨­å®š: ${url}`, 'success');
            }
        }

        async function startAutomation() {
            const formData = {
                url: document.getElementById('form-url').value,
                data: {
                    sender_name: document.getElementById('data-name').value,
                    sender_email: document.getElementById('data-email').value,
                    sender_company: document.getElementById('data-company').value,
                    sender_phone: document.getElementById('data-phone').value,
                    message: document.getElementById('data-message').value
                }
            };

            addLog('è‡ªå‹•å…¥åŠ›ã‚’é–‹å§‹ã—ã¾ã™...', 'info');
            updateStatus('å®Ÿè¡Œä¸­...', 'running');

            // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆå®Ÿéš›ã®APIå®Ÿè£…ã¯å¾Œã»ã©ï¼‰
            setTimeout(() => {
                addLog(`ãƒ•ã‚©ãƒ¼ãƒ URL: ${formData.url}`, 'info');
                addLog('ãƒ–ãƒ©ã‚¦ã‚¶ã‚’èµ·å‹•ã—ã¦ã„ã¾ã™...', 'info');
            }, 500);

            setTimeout(() => {
                addLog('ãƒšãƒ¼ã‚¸ã‚’èª­ã¿è¾¼ã¿ä¸­...', 'info');
            }, 1500);

            setTimeout(() => {
                addLog(`åå‰ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å…¥åŠ›: ${formData.data.sender_name}`, 'success');
                addLog(`ãƒ¡ãƒ¼ãƒ«ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å…¥åŠ›: ${formData.data.sender_email}`, 'success');
                addLog(`ä¼šç¤¾åãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å…¥åŠ›: ${formData.data.sender_company}`, 'success');
                addLog(`é›»è©±ç•ªå·ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å…¥åŠ›: ${formData.data.sender_phone}`, 'success');
                addLog('ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å…¥åŠ›å®Œäº†', 'success');
            }, 2500);

            setTimeout(() => {
                addLog('reCAPTCHAã‚’æ¤œå‡ºã—ã¾ã—ãŸ', 'warning');
                addLog('ä½œæ¥­è€…ã«ã‚ˆã‚‹æ‰‹å‹•å¯¾å¿œã‚’å¾…æ©Ÿä¸­...', 'warning');
                updateStatus('reCAPTCHAå¾…æ©Ÿä¸­ï¼ˆHuman-in-the-Loopï¼‰', 'idle');
            }, 3500);

            setTimeout(() => {
                addLog('âœ… è‡ªå‹•å…¥åŠ›ãŒå®Œäº†ã—ã¾ã—ãŸ', 'success');
                addLog('ğŸ’¡ å®Ÿéš›ã®å®Ÿè£…ã§ã¯ã€PlaywrightãŒãƒ–ãƒ©ã‚¦ã‚¶ã‚’åˆ¶å¾¡ã—ã¾ã™', 'info');
                updateStatus('å®Œäº†', 'success');
            }, 4500);
        }

        // åˆæœŸåŒ–
        addLog('ã‚·ã‚¹ãƒ†ãƒ æº–å‚™å®Œäº†', 'success');
        updateStatus('å¾…æ©Ÿä¸­', 'idle');
    </script>
</body>
</html>
